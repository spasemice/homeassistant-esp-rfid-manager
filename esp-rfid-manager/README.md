# ESP-RFID Manager - Home Assistant Addon

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É–ø—Ä–∞–≤—É–≤–∞—ö–µ –Ω–∞ ESP-RFID —É—Ä–µ–¥–∏, –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∞ –Ω–∞ –ø—Ä–∏—Å—Ç–∞–ø –ø—Ä–µ–∫—É MQTT.

## –ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### üè† –£–ø—Ä–∞–≤—É–≤–∞—ö–µ —Å–æ —É—Ä–µ–¥–∏
- –ê–≤—Ç–æ–º–∞—Ç—Å–∫–æ –æ—Ç–∫—Ä–∏–≤–∞—ö–µ –Ω–∞ ESP-RFID —É—Ä–µ–¥–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ —Å—Ç–∞—Ç—É—Å –≤–æ —Ä–µ–∞–ª–Ω–æ –≤—Ä–µ–º–µ (online/offline)
- Heartbeat –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –û—Ç–≤–æ—Ä–∞—ö–µ –≤—Ä–∞—Ç–∏ –ø—Ä–µ–∫—É MQTT –∫–æ–º–∞–Ω–¥–∏

### üë• –£–ø—Ä–∞–≤—É–≤–∞—ö–µ —Å–æ –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏
- –î–æ–¥–∞–≤–∞—ö–µ –Ω–æ–≤–∏ –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏ –ø—Ä–µ–∫—É –≤–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ—ò—Å
- –ê–≤—Ç–æ–º–∞—Ç—Å–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—ò–∞ –Ω–∞ –Ω–æ–≤–∏ –∫–∞—Ä—Ç–∏—á–∫–∏
- –ü–æ–¥–¥—Ä—à–∫–∞ –∑–∞ –≤—Ä–µ–º–µ–Ω—Å–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø—Ä–∏—Å—Ç–∞–ø
- –†–∞–∑–ª–∏—á–Ω–∏ —Ç–∏–ø–æ–≤–∏ –Ω–∞ –ø—Ä–∏—Å—Ç–∞–ø (Always, Admin, Disabled)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—ò–∞ –Ω–∞ –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏ —Å–æ ESP-RFID —É—Ä–µ–¥–∏—Ç–µ

### üìä –õ–æ–≥–æ–≤–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –õ–æ–≥–æ–≤–∏ –∑–∞ —Å–µ–∫–æ—ò –ø—Ä–∏—Å—Ç–∞–ø (–∫–æ—ò, –∫–æ–≥–∞, –∫–∞–¥–µ)
- –°–∏—Å—Ç–µ–º—Å–∫–∏ –≥–æ–¥–∏–Ω–∏ –∑–∞ —Å–∏—Ç–µ ESP-RFID —É—Ä–µ–¥–∏
- –†–µ–∞–ª–Ω–∏ –≤—Ä–µ–º—Å–∫–∏ –∞–∂—É—Ä–∏—Ä–∞—ö–∞ –ø—Ä–µ–∫—É WebSocket
- –§–∏–ª—Ç—Ä–∏—Ä–∞—ö–µ –Ω–∞ –ª–æ–≥–æ–≤–∏ –ø–æ —É—Ä–µ–¥

### üîß MQTT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—ò–∞
- –ö–æ–º—É–Ω–∏–∫–∞—Ü–∏—ò–∞ —Å–æ ESP-RFID —É—Ä–µ–¥–∏ –ø—Ä–µ–∫—É MQTT
- –ü–æ–¥–¥—Ä—à–∫–∞ –∑–∞ –ø–æ–≤–µ—ú–µ —É—Ä–µ–¥–∏
- –ê–≤—Ç–æ–º–∞—Ç—Å–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—ò–∞ –Ω–∞ MQTT —Ç–æ–ø–∏—Ü–∏
- Heartbeat –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

## –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞—ö–µ

1. –î–æ–¥–∞—ò—Ç–µ –≥–æ –æ–≤–æ—ò repository –≤–æ Home Assistant Add-on Store
2. –ò–Ω—Å—Ç–∞–ª–∏—Ä–∞—ò—Ç–µ –≥–æ "ESP-RFID Manager" addon-–æ—Ç
3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞—ò—Ç–µ –≥–∏ MQTT –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ
4. –°—Ç–∞—Ä—Ç—É–≤–∞—ò—Ç–µ –≥–æ addon-–æ—Ç

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—ò–∞

```yaml
mqtt_host: "127.0.0.1"
mqtt_port: 1883
mqtt_user: ""
mqtt_password: ""
mqtt_topic: "/rfid"
log_level: "info"
web_port: 8080
auto_discovery: true
```

### –û–ø—Ü–∏–∏

- `mqtt_host`: IP –∞–¥—Ä–µ—Å–∞ –∏–ª–∏ hostname –Ω–∞ MQTT broker-–æ—Ç
- `mqtt_port`: Port –Ω–∞ MQTT broker-–æ—Ç (default: 1883)
- `mqtt_user`: Username –∑–∞ MQTT (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)
- `mqtt_password`: Password –∑–∞ MQTT (–æ–ø—Ü–∏–æ–Ω–∞–ª–Ω–æ)
- `mqtt_topic`: –ë–∞–∑–∞ —Ç–æ–ø–∏–∫ –∑–∞ MQTT –∫–æ–º—É–Ω–∏–∫–∞—Ü–∏—ò–∞ (default: "/rfid")
- `log_level`: –ù–∏–≤–æ –Ω–∞ –ª–æ–≥–∏—Ä–∞—ö–µ (trace|debug|info|notice|warning|error|fatal)
- `web_port`: Port –∑–∞ –≤–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ—ò—Å–æ—Ç (default: 8080)
- `auto_discovery`: –ê–≤—Ç–æ–º–∞—Ç—Å–∫–æ –æ—Ç–∫—Ä–∏–≤–∞—ö–µ –Ω–∞ —É—Ä–µ–¥–∏ (default: true)

## –ö–æ—Ä–∏—Å—Ç–µ—ö–µ

### –ü—Ä–∏—Å—Ç–∞–ø –¥–æ –≤–µ–± –∏–Ω—Ç–µ—Ä—Ñ–µ—ò—Å–æ—Ç
–û—Ç–≤–æ—Ä–µ—Ç–µ –≤–µ–± –ø—Ä–µ–ª–∏—Å—Ç—É–≤–∞—á –∏ –æ–¥–µ—Ç–µ –Ω–∞:
```
http://homeassistant.local:8080
```

### –î–æ–¥–∞–≤–∞—ö–µ –Ω–æ–≤–∏ –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏

1. **–ê–≤—Ç–æ–º–∞—Ç—Å–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—ò–∞ –Ω–∞ –∫–∞—Ä—Ç–∏—á–∫–∏:**
   - –°–∫–µ–Ω–∏—Ä–∞—ò—Ç–µ –Ω–æ–≤–∞ –∫–∞—Ä—Ç–∏—á–∫–∞ –Ω–∞ –±–∏–ª–æ –∫–æ—ò ESP-RFID —É—Ä–µ–¥
   - –ö–∞—Ä—Ç–∏—á–∫–∞—Ç–∞ —ú–µ —Å–µ –ø–æ—ò–∞–≤–∏ –≤–æ "New Cards Detected" —Å–µ–∫—Ü–∏—ò–∞—Ç–∞
   - –ö–ª–∏–∫–Ω–µ—Ç–µ "Register" –∏ –≤–Ω–µ—Å–µ—Ç–µ –≥–∏ –ø–æ–¥–∞—Ç–æ—Ü–∏—Ç–µ –∑–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫–æ—Ç

2. **–†–∞—á–Ω–æ –¥–æ–¥–∞–≤–∞—ö–µ:**
   - –ö–ª–∏–∫–Ω–µ—Ç–µ –Ω–∞ "Add User" –∫–æ–ø—á–µ—Ç–æ
   - –í–Ω–µ—Å–µ—Ç–µ –∏–º–µ, UID –Ω–∞ –∫–∞—Ä—Ç–∏—á–∫–∞—Ç–∞, —É—Ä–µ–¥ –∏ –ø–µ—Ä–∏–æ–¥ –Ω–∞ –≤–∞–∂–Ω–æ—Å—Ç
   - –ö–ª–∏–∫–Ω–µ—Ç–µ "Add User"

### –£–ø—Ä–∞–≤—É–≤–∞—ö–µ —Å–æ –ø—Ä–∏—Å—Ç–∞–ø

- **Always**: –ö–æ—Ä–∏—Å–Ω–∏–∫–æ—Ç –∏–º–∞ –ø—Ä–∏—Å—Ç–∞–ø –≤–æ —Å–µ–∫–æ–µ –≤—Ä–µ–º–µ
- **Admin**: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—Å–∫–∏ –ø—Ä–∏—Å—Ç–∞–ø
- **Disabled**: –ü—Ä–∏—Å—Ç–∞–ø–æ—Ç –µ –æ–Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω

### –í—Ä–µ–º–µ–Ω—Å–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø—Ä–∏—Å—Ç–∞–ø

–ú–æ–∂–µ—Ç–µ –¥–∞ –ø–æ—Å—Ç–∞–≤–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –∫–æ–≥–∞ –∫–æ—Ä–∏—Å–Ω–∏–∫–æ—Ç –∏–º–∞ –ø—Ä–∏—Å—Ç–∞–ø:
- **Valid From**: –û–¥ –∫–æ–≥–∞ –≤–∞–∂–∏ –ø—Ä–∏—Å—Ç–∞–ø–æ—Ç
- **Valid Until**: –î–æ –∫–æ–≥–∞ –≤–∞–∂–∏ –ø—Ä–∏—Å—Ç–∞–ø–æ—Ç

## ESP-RFID –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—ò–∞

–ó–∞ –¥–∞ —Ä–∞–±–æ—Ç–∏ —Å–æ –æ–≤–æ—ò addon, –≤–∞—à–∏—Ç–µ ESP-RFID —É—Ä–µ–¥–∏ —Ç—Ä–µ–±–∞ –¥–∞ —Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–∞–Ω–∏ —Å–æ:

1. **MQTT –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω** —Å–æ –∏—Å—Ç–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–∞–∫–æ addon-–æ—Ç
2. **MQTT —Ç–æ–ø–∏–∫** –ø–æ—Å—Ç–∞–≤–µ–Ω –Ω–∞ –∏—Å—Ç–∏–æ—Ç –∫–∞–∫–æ –≤–æ addon-–æ—Ç (default: "/rfid")
3. **Send Logs via MQTT** –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–æ –∑–∞ –ª–æ–≥–æ–≤–∏
4. **Send Events via MQTT** –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–æ –∑–∞ —Å—ä–±–∏—Ç–∏—è

## API

Addon-ot –æ–±–µ–∑–±–µ–¥—É–≤–∞ REST API –∑–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—ò–∞:

### Devices
- `GET /api/devices` - –õ–∏—Å—Ç–∞ –Ω–∞ —É—Ä–µ–¥–∏
- `POST /api/doors/open` - –û—Ç–≤–æ—Ä–∏ –≤—Ä–∞—Ç–∞

### Users  
- `GET /api/users` - –õ–∏—Å—Ç–∞ –Ω–∞ –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏
- `POST /api/users` - –î–æ–¥–∞—ò –∫–æ—Ä–∏—Å–Ω–∏–∫
- `DELETE /api/users/{id}` - –ò–∑–±—Ä–∏—à–∏ –∫–æ—Ä–∏—Å–Ω–∏–∫

### Logs
- `GET /api/access-logs` - –õ–æ–≥–æ–≤–∏ –∑–∞ –ø—Ä–∏—Å—Ç–∞–ø
- `GET /api/card-registrations` - –ö–∞—Ä—Ç–∏—á–∫–∏ –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—ò–∞

## –ü—Ä–∏–º–µ—Ä–∏ –Ω–∞ MQTT –ø–æ—Ä–∞–∫–∏

### –î–æ–¥–∞–≤–∞—ö–µ –∫–æ—Ä–∏—Å–Ω–∏–∫
```json
{
  "cmd": "adduser",
  "doorip": "192.168.1.100",
  "uid": "1234567890",
  "user": "–ú–∞—Ä–∫–æ –ü–µ—Ç—Ä–æ–≤—Å–∫–∏",
  "acctype": "1",
  "validsince": "0",
  "validuntil": "1735689600"
}
```

### –û—Ç–≤–æ—Ä–∞—ö–µ –≤—Ä–∞—Ç–∞
```json
{
  "cmd": "opendoor", 
  "doorip": "192.168.1.100"
}
```

### Access log (–æ–¥ ESP-RFID)
```json
{
  "type": "access",
  "time": 1605991375,
  "isKnown": "true",
  "access": "Always",
  "username": "–ú–∞—Ä–∫–æ –ü–µ—Ç—Ä–æ–≤—Å–∫–∏",
  "uid": "1234567890",
  "hostname": "esp-rfid-door1",
  "doorName": "Main Door"
}
```

## Troubleshooting

### MQTT –ø—Ä–æ–±–ª–µ–º–∏
1. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ MQTT broker-–æ—Ç —Ä–∞–±–æ—Ç–∏
2. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ –∑–∞ –ø–æ–≤—Ä–∑—É–≤–∞—ö–µ —Å–µ —Ç–æ—á–Ω–∏
3. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ ESP-RFID —É—Ä–µ–¥–∏—Ç–µ –∫–æ—Ä–∏—Å—Ç–∞—Ç –∏—Å—Ç —Ç–æ–ø–∏–∫

### –£—Ä–µ–¥–∏—Ç–µ –Ω–µ —Å–µ –ø–æ–≤—Ä–∑—É–≤–∞–∞—Ç
1. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ ESP-RFID —É—Ä–µ–¥–∏—Ç–µ —Å–µ –Ω–∞ –∏—Å—Ç–∞—Ç–∞ –º—Ä–µ–∂–∞
2. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ MQTT –µ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω –Ω–∞ —É—Ä–µ–¥–∏—Ç–µ
3. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –ª–æ–≥–æ–≤–∏—Ç–µ –Ω–∞ addon-–æ—Ç

### –ü—Ä–æ–±–ª–µ–º–∏ —Å–æ –¥–æ–¥–∞–≤–∞—ö–µ –∫–æ—Ä–∏—Å–Ω–∏—Ü–∏
1. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ —É—Ä–µ–¥–æ—Ç –µ online
2. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ –¥–∞–ª–∏ UID-–æ—Ç –Ω–∞ –∫–∞—Ä—Ç–∏—á–∫–∞—Ç–∞ –µ —Ç–æ—á–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä–µ—Ç–µ MQTT –ª–æ–≥–æ–≤–∏—Ç–µ

## –ü–æ–¥–¥—Ä—à–∫–∞

–ó–∞ –ø—Ä–∞—à–∞—ö–∞ –∏ –ø—Ä–æ–±–ª–µ–º–∏, –æ—Ç–≤–æ—Ä–µ—Ç–µ issue –Ω–∞ GitHub repository-—Ç–æ.

## –õ–∏—Ü–µ–Ω—Ü–∞

MIT License - –≤–∏–¥–µ—Ç–µ LICENSE —Ñ–∞—ò–ª–æ—Ç –∑–∞ –¥–µ—Ç–∞–ª–∏. 